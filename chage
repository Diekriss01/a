#include <Wire.h>
#include <LiquidCrystal.h>

LiquidCrystal lcd(12, 11, 5, 4, 3, 2); // Adjust pin numbers if necessary

const byte coinDropPin = 7; // Digital pin connected to the coin drop sensor from IC510T TB510
int coinCount = 0; // Counter for the number of coins
bool lastState = true; // Variable to store the previous state of the coin drop pin

void setup() {
  lcd.begin(16, 2); // Initialize the LCD
  lcd.setCursor(0, 0);
  lcd.print("Coins detected:");
  lcd.setCursor(0, 1);
  lcd.print("Ready for coins"); // Display message indicating readiness to detect coins
  pinMode(coinDropPin, INPUT_PULLUP); // Set coin drop pin as input with internal pull-up resistor
  Serial.begin(9600); // Initialize serial communication
}

void loop() {
  bool currentState = digitalRead(coinDropPin); // Get the current state of the coin drop pin

  // Check if the current state is different from the previous state
  if (currentState != lastState) {
    // If the current state is HIGH, a coin is detected
    if (currentState == LOW) {
      coinCount++; // Increment the coin count
      lcd.setCursor(0, 1);
      lcd.print("          "); // Clear the previous count
      lcd.setCursor(0, 1);
      lcd.print(coinCount); // Update the LCD display with the new coin count
    } else { // If the current state is LOW, the coin is removed
      lcd.setCursor(0, 1);
      lcd.print("Ready for coins    "); // Display message indicating readiness to detect coins
    }
    delay(50); // Debounce delay to avoid false triggers
  }

  lastState = currentState; // Update the last state with the current state
}
